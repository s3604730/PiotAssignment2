#pip install python-google-calendar-api
from __future__ import print_function
from datetime import datetime
from datetime import timedelta
from googleapiclient.discovery import build
from httplib2 import Http
from oauth2client import file, client, tools

class Calendar:


    def __init(self):
        SCOPES = 'https://www.googleapis.com/auth/calendar'
        store = file.Storage('storage.json')
        creds = store.get()
            if not creds or creds.invalid:
                flow = client.flow_from_clientsecrets('client_secret.json', SCOPES)
                creds = tools.run_flow(flow, store)
        GCAL = discovery.build('calendar', 'v3', http=creds.authorize(Http()))


    def get_credentials():
        home_dir = os.path.expanduser('~')
   credential_dir = os.path.join(home_dir, '.credentials')
   if not os.path.exists(credential_dir):
       os.makedirs(credential_dir)
   credential_path = os.path.join(credential_dir,
                                  'calendar-python-quickstart.json')
 
   store = Storage(credential_path)
   credentials = store.get()
   if not credentials or credentials.invalid:
       flow = client.flow_from_clientsecrets(CLIENT_SECRET_FILE, SCOPES)
       flow.user_agent = APPLICATION_NAME
       if flags:
           credentials = tools.run_flow(flow, store, flags)
       else:
           credentials = tools.run(flow, store)
       print('Storing credentials to ' + credential_path)
   return credentials

    def insertEvent():
        http = credentials.authorize(httplib2.Http())
        service = discovery.build('calendar', 'v3', http=http)

        GMT_OFF = '+05:30'    
        event = 
        {
        'summary': 'Dinner with friends',
        'start':   {'dateTime': '2017-05-28T19:00:00%s' % GMT_OFF},
        'end':     {'dateTime': '2015-05-28T22:00:00%s' % GMT_OFF},
        }
 
        event = service.events().insert(calendarId='primary', body=event).execute()
        print('Event created: %s' % (event.get('htmlLink')))